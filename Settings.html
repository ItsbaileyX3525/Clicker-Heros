<!DOCTYPE html>
<html>
<style>
body{
    background-image:url('assets/Settingsbg.png');
}
</style>
<body>
    <div id='Smooth' style="z-index: -123;position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;background-color: black; opacity: 1;"></div>
    <script src="Smooth.js"></script>
    
    <script>


music = new Audio('assets/settingsbgsong.ogg')

music.play();
music.loop = true;

function setVolumeForAudioArray(volumee) {
    var vol = volumee/100
    music.volume = parseFloat(vol);
}

const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'image/*';
    fileInput.style.borderRadius = '10px';
    fileInput.style.opacity = 0;
    
    const uploadedImage = document.createElement('img');
    uploadedImage.style.maxWidth = '100%';
    uploadedImage.style.opacity = 0;
    
    fileInput.addEventListener('change', function(event) {
      const file = event.target.files[0];
      if (file) {
        if (file.size <= 2 * 1024 * 1024) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            const imageData = e.target.result;
            localStorage.setItem('customBG', imageData);
            uploadedImage.src = imageData;
          };
          
          reader.readAsDataURL(file);
        } else {
          fileInput.value = ''; // Clear the file input
        }
      }
    });

    </script>
    <script src="taptapir/taptapir.js"></script>
<script src="taptapir-utility/slider.js"></script>
<script type="text/sunsnake">

#Global Functions
set_orientation('horizontal')
set_window_color('transparent')
set_background_color('black')
ASSETS_FOLDER = 'assets/'

volume = round(parseFloat(save_system_load('mastervolume')), 10)
if not volume:
    volume = 1
volume = volume * 100
PrevTab = save_system_load('prevtab')
allowedAttackSFX = save_system_load('attacksfx')
GoBackButton = Button(texture='LeftArrow.webp',y=.425,x=-.8,scale=[.1,.1])
GoBackButton.on_click = def():
    if PrevTab == 'menu':
        SmoothTransit('Menu')
    elif PrevTab == 'main':
        SmoothTransit('main')

attackSFX = Checkbox(state=allowedAttackSFX,y=.165,x=-.22)
attackSFXText = Text(text='Click sounds: ',y=-.31,x=-.048)


masterVolume = new Slider({y:.315,scale:[0.4,0.03],background_color:rgb(57, 66, 92)})

masterVolumeVolume = Text(text='',x=.365,y=-.1)
masterVolumeVolume.update = def():
    masterVolumeVolume.text = masterVolume.value

masterVolumeText = Text(text='Master volume: ',x=-.05,y=-.16)
masterVolume.setValue(volume)


#Custom background

CustomBackground = Button(enabled=True,scale_y=.1,y=-0.4,x=-0.5,text='Change background')
#CustomBackground.el.appendChild(fileInput)
CustomBackground.fit_to_text()
CustomBackground.on_click = def():
    Sowwyppl = Text(text='Not supported yet',y=-0.45,x=.275,text_color=color.red)
    after 2:
        destroy(Sowwyppl)

Credits = Button(text='Credits',y=-.4,x=.5,scale=[.2,.1],color=color.gray,text_color=color.white)
Credits.on_click = def():
    SmoothTransit('Credits')

#Because Rangers thing sucks
entityUpdater = Entity(alpha=0)
entityUpdater.update = def():
    save_system_save("mastervolume", masterVolume.value/100)
    save_system_save("attacksfx", attackSFX.value)
    setVolumeForAudioArray(masterVolume.value);
    




#Reset game stuff (very dangerous all progress lost)
resetGame = Button(y=-.4,text='RESET',scale=[.2,.1],color=color.red)
resetGame.on_click = def():
    SmoothTransit('Reset')
    




_hidden_fullscreen_button.xy = [213213213,123123123]
</script>
<script src="taptapir/sunsnake_compiler.js"></script>
</body>
</html>