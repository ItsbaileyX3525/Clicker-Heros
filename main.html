<!DOCTYPE html>
<html>
<style>
body{
    background-image:url('assets/bg.webp');
}
</style>
<body>
    <div id='Smooth' style="z-index: -123;position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;background-color: black; opacity: 1;"></div>
    <script src="Smooth.js"></script>
    <script>

function random_int_(min, max) {//In taptapir but taptap is defined before goodness
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}  

function Playwoosh() {
   if (!allowedAttackSFX) {
    ;
   } else {
    swoosh = random_int_(1,3);
    if (swoosh === 1) {
      woosh = new Audio('assets/woosh1.ogg')
    } else if (swoosh === 2) {
      woosh = new Audio('assets/woosh2.ogg')
    } else {
      woosh = new Audio('assets/woosh3.ogg')
    }
    woosh.volume = parseFloat(window.localStorage.getItem('mastervolume'))
    woosh.play()

    woosh.addEventListener('ended', function() {
      woosh.remove();
    })};
}

const songs = {
  song1: new Audio('assets/bgsong.ogg')
}

const songArray = Object.values(songs);

function getRandomSong() {
  const randomIndex = Math.floor(Math.random() * songArray.length);
  const current = songArray[randomIndex]
  if (current.paused) {
    return current;
  }
  
}

StartedSong = getRandomSong();
StartedSong.play();
StartedSong.loop = true;
window.addEventListener('click', (event) => {
  if (StartedSong.paused) {
    StartedSong.play();
    //alert("Why was the audio paused?")
  }
})
function setVolumeForAudioArrays(audioArrays, volume) {
    audioArrays.forEach(audioArray => {
        audioArray.forEach(element => {
            element.volume = volume;
        });
    });
}

const savedImageData = localStorage.getItem('customBG');
    if (savedImageData) {
      document.body.style.backgroundImage = `url(${savedImageData})`;    }

function formatNumber(number) {
  if (number >= 1000){
  if (number >= 1e12) {
    return (number / 1e12).toFixed(2) + 'T';
  } else if (number >= 1e9) {
    return (number / 1e9).toFixed(2) + 'B';
  } else if (number >= 1e6) {
    return (number / 1e6).toFixed(2) + 'M';
  } else if (number >= 1e3) {
    return (number / 1e3).toFixed(2) + 'K';
  } else {
    return number.toFixed(2);
  }} else {return number}
}


    </script>

    <script src="taptapir/taptapir.js"></script>
<script type="text/sunsnake">

#Global Functions
set_orientation('horizontal')
set_window_color('transparent')
set_background_color('black')
ASSETS_FOLDER = 'assets/'

#For settings
save_system_save('prevtab', "main")

#Loading score and data etc.
score = int(save_system_load('score'))
if not score:
    score = 0

volume = parseFloat(save_system_load('mastervolume'))
if not volume:
  volume = 1
  save_system_save('mastervolume', volume)
setVolumeForAudioArrays([songArray], volume);
  
allowedAttackSFX = save_system_load('attacksfx')
if allowedAttackSFX == null:
    allowedAttackSFX = True
    save_system_save('attacksfx', allowedAttackSFX)

#Main clicker game
ClickerDude = Button(texture='Clicker-idle.gif',scale=[.3,.3],y=0)
ClickerDude.on_click = def():
    score += 1
    Playwoosh()

score_display = Text(text=`Clicks: ${score}`,xy=top)
score_display.update = def():
    Fscore = formatNumber(score);
    score_display.text = `Clicks: ${Fscore}`

settingsButton = Button(texture='settingsCog.webp',scale=.1,x=.8,y=.45)
settingsButton.on_click = def():
    SmoothTransit("Settings")

#General updating stuff
def update():
    save_system_save('score', score)
    
ShopButton = Button(texture='shopCog.png',x=.75,scale=.2,y=-.02)










_hidden_fullscreen_button.xy = [213213213,123123123]
</script>
<script src="taptapir/sunsnake_compiler.js"></script>
</body>
</html>